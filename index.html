<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meow Script Web</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ff4d6d;
            --secondary-color: #6c63ff;
            --accent-color: #00d4aa;
            --danger-color: #ff4757;
            --warning-color: #ffaa00;
            --success-color: #00d166;
            
            --bg-primary: #0a0a0f;
            --bg-secondary: #111118;
            --bg-card: #1a1a24;
            --bg-input: #22222f;
            
            --text-primary: #ffffff;
            --text-secondary: #b0b0c0;
            --text-muted: #8888a0;
            
            --border-color: #2d2d3a;
            --border-light: #3a3a4a;
            
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            
            --glow-primary: 0 0 10px rgba(255, 77, 109, 0.3);
            --glow-secondary: 0 0 10px rgba(108, 99, 255, 0.3);
            
            --gradient-bg: linear-gradient(135deg, #0a0a0f 0%, #151522 100%);
            --gradient-primary: linear-gradient(135deg, #ff4d6d 0%, #ff758f 100%);
            --gradient-secondary: linear-gradient(135deg, #6c63ff 0%, #8a84ff 100%);
            --gradient-accent: linear-gradient(135deg, #00d4aa 0%, #00ffc3 100%);
        }

        .light-theme {
            --primary-color: #ff4d6d;
            --secondary-color: #6c63ff;
            --accent-color: #00b894;
            --danger-color: #e84118;
            --warning-color: #f39c12;
            --success-color: #00b894;
            
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --bg-input: #f1f3f4;
            
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --text-muted: #7f8c8d;
            
            --border-color: #dfe6e9;
            --border-light: #e0e0e0;
            
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.15);
            
            --glow-primary: 0 0 8px rgba(255, 77, 109, 0.15);
            --glow-secondary: 0 0 8px rgba(108, 99, 255, 0.15);
            
            --gradient-bg: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            --gradient-primary: linear-gradient(135deg, #ff4d6d 0%, #ff758f 100%);
            --gradient-secondary: linear-gradient(135deg, #6c63ff 0%, #8a84ff 100%);
            --gradient-accent: linear-gradient(135deg, #00b894 0%, #00d4aa 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gradient-bg);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-sm);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo i {
            font-size: 1.8rem;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        .theme-toggle:hover {
            background: var(--bg-card);
            color: var(--primary-color);
        }

        .auth-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 0.6rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow-sm);
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .username {
            color: var(--text-primary);
            font-weight: 500;
        }

        .user-badge {
            background: var(--accent-color);
            color: white;
            padding: 0.2rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Navigation */
        .nav-container {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 0.5rem 2rem;
            position: sticky;
            top: 70px;
            z-index: 999;
            box-shadow: var(--shadow-sm);
        }

        .nav-tabs {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .nav-tab {
            padding: 0.8rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 10px;
            color: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-tab:hover {
            background: var(--bg-input);
            color: var(--primary-color);
        }

        .nav-tab.active {
            background: var(--bg-card);
            color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }

        /* Main Content */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            min-height: calc(100vh - 140px);
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* Script Grid */
        .script-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .script-grid {
                grid-template-columns: 1fr;
            }
        }

        .script-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .script-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }

        .script-thumbnail {
            height: 200px;
            background: var(--bg-input);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .script-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .upload-thumbnail {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
            color: var(--text-muted);
        }

        .upload-thumbnail:hover {
            color: var(--primary-color);
        }

        .script-info {
            padding: 1.5rem;
        }

        .script-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .script-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .script-author {
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .script-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .script-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--glow-primary);
        }

        .btn-secondary {
            background: var(--bg-input);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-card);
            border-color: var(--primary-color);
        }

        .btn-accent {
            background: var(--gradient-accent);
            color: white;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        /* Forms */
        .form-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 0.8rem 1rem;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 77, 109, 0.1);
        }

        .form-textarea {
            min-height: 150px;
            resize: vertical;
            font-family: 'Consolas', monospace;
            line-height: 1.5;
        }

        /* Chat System - Clean Version */
        .chat-page {
            max-width: 1200px;
            margin: 0 auto;
        }

        .chat-messages {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            max-height: 500px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 80%;
            padding: 0.8rem 1rem;
            border-radius: 15px;
            position: relative;
        }

        .message-sent {
            align-self: flex-end;
            background: var(--gradient-primary);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-received {
            align-self: flex-start;
            background: var(--bg-input);
            color: var(--text-primary);
            border-bottom-left-radius: 5px;
        }

        .message-sender {
            font-weight: 600;
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
            display: none; /* Ẩn tên cho tin nhắn của chính mình */
        }

        .message-received .message-sender {
            display: block; /* Chỉ hiện tên cho tin nhắn người khác */
        }

        .message-content {
            word-wrap: break-word;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 0.3rem;
            text-align: right;
        }

        .chat-input-container {
            display: flex;
            gap: 1rem;
            background: var(--bg-card);
            padding: 1rem;
            border-radius: 15px;
        }

        .chat-input {
            flex: 1;
            padding: 0.8rem 1rem;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            color: var(--text-primary);
        }

        .chat-send-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Admin Panel */
        .admin-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
        }

        .admin-section h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .moderator-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .moderator-card {
            background: var(--bg-input);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 15px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
        }

        /* Script Viewer */
        .script-viewer {
            background: #1a1a24;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
        }

        .script-code {
            color: #00d4aa;
            font-family: 'Consolas', monospace;
            white-space: pre-wrap;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            box-shadow: var(--shadow-lg);
            display: none;
            z-index: 3000;
            align-items: center;
            gap: 0.75rem;
            max-width: 350px;
        }

        .notification.active {
            display: flex;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-input);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header, .nav-container, .main-container {
                padding: 1rem;
            }
            
            .page-title {
                font-size: 1.8rem;
            }
            
            .form-container {
                padding: 1.5rem;
            }
            
            .chat-messages {
                max-height: 400px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .header-controls {
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .script-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .nav-tabs {
                gap: 0.25rem;
            }
            
            .nav-tab {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            
            .chat-input-container {
                flex-direction: column;
            }
            
            .chat-send-btn {
                width: 100%;
                border-radius: 25px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-code"></i>
                <span>Meow Script Web</span>
            </div>
            
            <div class="header-controls">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
                
                <div class="user-menu" id="userMenu">
                    <!-- Will be populated by JS -->
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-container">
        <div class="nav-tabs">
            <button class="nav-tab active" data-page="info">
                <i class="fas fa-info-circle"></i> Info
            </button>
            <button class="nav-tab" data-page="home">
                <i class="fas fa-home"></i> Home
            </button>
            <button class="nav-tab" data-page="share-source">
                <i class="fas fa-share-alt"></i> Share Source
            </button>
            <button class="nav-tab" data-page="member-share">
                <i class="fas fa-users"></i> Member Share
            </button>
            <button class="nav-tab admin-only" data-page="admin" style="display: none;">
                <i class="fas fa-user-shield"></i> Admin Panel
            </button>
            <button class="nav-tab" data-page="chat">
                <i class="fas fa-comments"></i> Member Chat
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Info Page -->
        <div id="info-page" class="page active">
            <div class="page-header">
                <h1 class="page-title">Info</h1>
            </div>
            
            <div class="script-grid">
                <div class="script-card">
                    <div class="script-thumbnail" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fab fa-discord fa-3x" style="color: white;"></i>
                    </div>
                    <div class="script-info">
                        <h3 class="script-title">Discord Community</h3>
                        <p class="script-description">Join our Discord server for real-time discussions, support, and script sharing.</p>
                        <a href="https://discord.gg/sWtCuDf6zw" target="_blank" class="btn btn-primary">
                            <i class="fab fa-discord"></i> Join Discord
                        </a>
                    </div>
                </div>
                
                <div class="script-card">
                    <div class="script-thumbnail" style="background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);">
                        <i class="fab fa-youtube fa-3x" style="color: white;"></i>
                    </div>
                    <div class="script-info">
                        <h3 class="script-title">YouTube Channel</h3>
                        <p class="script-description">Subscribe to our YouTube channel for tutorials, script showcases, and gaming content.</p>
                        <a href="https://www.youtube.com/@Anura-gaming-real" target="_blank" class="btn btn-primary">
                            <i class="fab fa-youtube"></i> Subscribe
                        </a>
                    </div>
                </div>
                
                <div class="script-card">
                    <div class="script-thumbnail" style="background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);">
                        <i class="fas fa-users fa-3x" style="color: white;"></i>
                    </div>
                    <div class="script-info">
                        <h3 class="script-title">Zalo Group</h3>
                        <p class="script-description">Join our Zalo group for local community discussions and script sharing.</p>
                        <a href="https://zalo.me/g/mrzpvn566" target="_blank" class="btn btn-primary">
                            <i class="fas fa-users"></i> Join Group
                        </a>
                    </div>
                </div>
                
                <div class="script-card">
                    <div class="script-thumbnail" style="background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);">
                        <i class="fab fa-tiktok fa-3x" style="color: white;"></i>
                    </div>
                    <div class="script-info">
                        <h3 class="script-title">TikTok</h3>
                        <p class="script-description">Follow us on TikTok for short videos, script previews, and gaming highlights.</p>
                        <a href="https://tiktok.com/@anura_gaming" target="_blank" class="btn btn-primary">
                            <i class="fab fa-tiktok"></i> Follow
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="page">
            <div class="page-header">
                <h1 class="page-title">Home</h1>
            </div>
            
            <div class="script-grid" id="home-script-grid">
                <!-- Scripts loaded dynamically -->
            </div>
        </div>

        <!-- Share Source Page -->
        <div id="share-source-page" class="page">
            <div class="page-header">
                <h1 class="page-title">Share Source</h1>
            </div>
            
            <div class="form-container" id="share-source-form">
                <div class="form-group">
                    <label class="form-label">Script Title</label>
                    <input type="text" class="form-input" id="source-title" placeholder="Enter script name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-input" id="source-description" placeholder="Brief description">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Lua Script</label>
                    <textarea class="form-input form-textarea" id="source-content" placeholder="Paste your Lua script here..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Thumbnail Image</label>
                    <div class="upload-thumbnail" id="source-thumbnail-upload">
                        <i class="fas fa-cloud-upload-alt fa-3x"></i>
                        <p>Click to upload thumbnail</p>
                        <input type="file" accept="image/*" style="display: none;" id="source-image-input">
                    </div>
                    <img id="source-image-preview" style="display: none; max-width: 200px; margin-top: 1rem; border-radius: 8px;">
                </div>
                
                <button class="btn btn-primary" id="submit-source" style="width: 100%;">
                    <i class="fas fa-upload"></i> Share Source
                </button>
            </div>
            
            <div class="script-grid" id="source-script-grid">
                <!-- Source scripts loaded dynamically -->
            </div>
        </div>

        <!-- Member Share Page -->
        <div id="member-share-page" class="page">
            <div class="page-header">
                <h1 class="page-title">Member Share</h1>
            </div>
            
            <div class="form-container" id="member-form">
                <div class="form-group">
                    <label class="form-label">Script Title</label>
                    <input type="text" class="form-input" id="member-title" placeholder="Enter script name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-input" id="member-description" placeholder="Brief description">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Lua Script</label>
                    <textarea class="form-input form-textarea" id="member-content" placeholder="Paste your Lua script here..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Thumbnail Image (Optional)</label>
                    <div class="upload-thumbnail" id="member-thumbnail-upload">
                        <i class="fas fa-cloud-upload-alt fa-3x"></i>
                        <p>Click to upload thumbnail</p>
                        <input type="file" accept="image/*" style="display: none;" id="member-image-input">
                    </div>
                    <img id="member-image-preview" style="display: none; max-width: 200px; margin-top: 1rem; border-radius: 8px;">
                </div>
                
                <button class="btn btn-primary" id="submit-member" style="width: 100%;">
                    <i class="fas fa-share"></i> Share Script
                </button>
            </div>
            
            <div class="script-grid" id="member-script-grid">
                <!-- Member scripts loaded dynamically -->
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="admin-page" class="page">
            <div class="page-header">
                <h1 class="page-title">Admin Panel</h1>
            </div>
            
            <!-- ADD NEW SCRIPT SECTION -->
            <div class="admin-section">
                <h3><i class="fas fa-plus-circle"></i> Add New Script</h3>
                <div class="form-group">
                    <label class="form-label">Script Title</label>
                    <input type="text" class="form-input" id="admin-add-title" placeholder="Enter script name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-input" id="admin-add-description" placeholder="Enter script description">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Lua Script Content</label>
                    <textarea class="form-input form-textarea" id="admin-add-content" placeholder="Paste Lua script here..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Thumbnail Image</label>
                    <div class="upload-thumbnail" id="admin-add-thumbnail-upload">
                        <i class="fas fa-cloud-upload-alt fa-3x"></i>
                        <p>Click to upload thumbnail</p>
                        <input type="file" accept="image/*" style="display: none;" id="admin-add-image-input">
                    </div>
                    <img id="admin-add-image-preview" style="display: none; max-width: 200px; margin-top: 1rem; border-radius: 8px;">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Script Type</label>
                    <select class="form-input" id="admin-add-type">
                        <option value="script">Home Script</option>
                        <option value="source">Share Source</option>
                        <option value="member">Member Share</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" id="admin-add-script-btn" style="width: 100%;">
                    <i class="fas fa-plus"></i> Add Script
                </button>
            </div>
            
            <!-- MANAGE MODERATORS SECTION -->
            <div class="admin-section">
                <h3><i class="fas fa-user-shield"></i> Manage Moderators</h3>
                <div class="form-group">
                    <label class="form-label">Add Moderator by Username</label>
                    <div style="display: flex; gap: 1rem;">
                        <input type="text" class="form-input" id="mod-username" placeholder="Enter username">
                        <button class="btn btn-primary" id="add-moderator">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                </div>
                
                <div id="moderator-list">
                    <!-- Moderators loaded dynamically -->
                </div>
            </div>
            
            <!-- MANAGE ALL SCRIPTS SECTION -->
            <div class="admin-section">
                <h3><i class="fas fa-code"></i> Manage All Scripts</h3>
                <div class="script-grid" id="admin-script-grid">
                    <!-- All scripts with admin controls -->
                </div>
            </div>
        </div>

        <!-- Member Chat - Clean Version -->
        <div id="chat-page" class="page">
            <div class="chat-page">
                <div class="page-header">
                    <h1 class="page-title">Member Chat</h1>
                </div>
                
                <div class="chat-messages" id="chat-messages">
                    <!-- Messages loaded dynamically -->
                    <div class="message message-received">
                        <div class="message-sender" style="color: #00d4aa;">System</div>
                        <div class="message-content">Welcome to Meow Script Chat! Login to start chatting.</div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
                
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chat-input" placeholder="Type your message...">
                    <button class="chat-send-btn" id="send-message">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Script Viewer Modal -->
    <div class="modal" id="script-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-script-title">Script Title</h2>
                <button class="modal-close" id="close-script-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modal-script-description" style="color: var(--text-secondary); margin-bottom: 1rem;"></p>
                <div class="script-viewer">
                    <pre class="script-code" id="modal-script-content">// Script content will appear here</pre>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="btn btn-primary" id="copy-script-btn">
                        <i class="fas fa-copy"></i> Copy Script
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="login-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-user"></i> Login / Register
                </h2>
                <button class="modal-close" id="close-login-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="login-username" placeholder="Enter username">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="login-password" placeholder="Enter password">
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-primary" id="login-btn" style="flex: 1;">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button class="btn btn-secondary" id="register-btn" style="flex: 1;">
                        <i class="fas fa-user-plus"></i> Register
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle" id="notification-icon"></i>
        <span id="notification-text">Notification message</span>
    </div>

    <script>
        // Application State Management
        class AppState {
            constructor() {
                this.APP_NAME = 'MeowScriptWeb_v2';
                this.loadState();
            }
            
            loadState() {
                const saved = localStorage.getItem(this.APP_NAME);
                if (saved) {
                    const state = JSON.parse(saved);
                    this.users = state.users || [];
                    this.scripts = state.scripts || [];
                    this.sourceScripts = state.sourceScripts || [];
                    this.memberScripts = state.memberScripts || [];
                    this.moderators = state.moderators || [];
                    this.chatMessages = state.chatMessages || [];
                    this.currentUser = state.currentUser || null;
                } else {
                    this.resetToDefault();
                }
            }
            
            resetToDefault() {
                this.users = [
                    {
                        id: 'admin',
                        username: 'Anura123',
                        password: 'Anura123',
                        role: 'admin',
                        color: '#ff4d6d',
                        createdAt: new Date().toISOString()
                    }
                ];
                
                this.scripts = [
                    {
                        id: '1',
                        title: 'Auto Farm Resources',
                        description: 'Automatically farm game resources with high efficiency',
                        content: `-- Auto Farm Script\nlocal player = game.Players.LocalPlayer\n\nfunction farmResources()\n    while true do\n        -- Farming logic here\n        wait(1)\n    end\nend\n\nfarmResources()`,
                        author: 'Admin',
                        authorColor: '#ff4d6d',
                        thumbnail: '',
                        createdAt: new Date().toISOString(),
                        type: 'script'
                    },
                    {
                        id: '2',
                        title: 'ESP Hack',
                        description: 'Display player positions and items on map',
                        content: `-- ESP Script\nlocal players = game:GetService("Players")\n\nfor _, player in pairs(players:GetPlayers()) do\n    -- ESP logic here\nend`,
                        author: 'Admin',
                        authorColor: '#ff4d6d',
                        thumbnail: '',
                        createdAt: new Date().toISOString(),
                        type: 'script'
                    }
                ];
                
                this.sourceScripts = [];
                this.memberScripts = [];
                this.moderators = [];
                this.chatMessages = [
                    {
                        id: '1',
                        sender: 'System',
                        senderColor: '#00d4aa',
                        content: 'Welcome to Meow Script Chat! Login to start chatting.',
                        timestamp: new Date().toISOString()
                    }
                ];
                this.currentUser = null;
                
                this.saveState();
            }
            
            saveState() {
                const state = {
                    users: this.users,
                    scripts: this.scripts,
                    sourceScripts: this.sourceScripts,
                    memberScripts: this.memberScripts,
                    moderators: this.moderators,
                    chatMessages: this.chatMessages,
                    currentUser: this.currentUser,
                    lastUpdated: new Date().toISOString()
                };
                localStorage.setItem(this.APP_NAME, JSON.stringify(state));
            }
            
            // User Management
            registerUser(username, password) {
                if (this.users.some(u => u.username === username)) {
                    return { success: false, message: 'Username already exists' };
                }
                
                const colors = ['#ff4d6d', '#6c63ff', '#00d4aa', '#ffaa00', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ff9a00', '#da70d6'];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                
                const newUser = {
                    id: Date.now().toString(),
                    username,
                    password,
                    role: 'member',
                    color: randomColor,
                    createdAt: new Date().toISOString()
                };
                
                this.users.push(newUser);
                this.saveState();
                return { success: true, user: newUser };
            }
            
            loginUser(username, password) {
                const user = this.users.find(u => u.username === username && u.password === password);
                if (user) {
                    this.currentUser = user;
                    this.saveState();
                    return { success: true, user };
                }
                return { success: false, message: 'Invalid username or password' };
            }
            
            logout() {
                this.currentUser = null;
                this.saveState();
            }
            
            isAdmin() {
                return this.currentUser && this.currentUser.role === 'admin';
            }
            
            isModerator() {
                return this.currentUser && (this.currentUser.role === 'admin' || this.currentUser.role === 'moderator');
            }
            
            // Moderator Management
            addModerator(username) {
                const user = this.users.find(u => u.username === username);
                if (!user) {
                    return { success: false, message: 'User not found' };
                }
                
                if (user.role === 'moderator' || user.role === 'admin') {
                    return { success: false, message: 'User is already a moderator or admin' };
                }
                
                user.role = 'moderator';
                if (!this.moderators.includes(username)) {
                    this.moderators.push(username);
                }
                this.saveState();
                return { success: true, message: `${username} is now a moderator` };
            }
            
            removeModerator(username) {
                const user = this.users.find(u => u.username === username);
                if (user && user.role === 'moderator') {
                    user.role = 'member';
                    this.moderators = this.moderators.filter(m => m !== username);
                    this.saveState();
                    return { success: true, message: `${username} is no longer a moderator` };
                }
                return { success: false, message: 'User not found or not a moderator' };
            }
            
            // Script Management - ADD NEW METHOD
            addScriptByAdmin(scriptData, type = 'script') {
                const script = {
                    id: Date.now().toString(),
                    ...scriptData,
                    type,
                    createdAt: new Date().toISOString()
                };
                
                if (type === 'script') {
                    this.scripts.push(script);
                } else if (type === 'source') {
                    this.sourceScripts.push(script);
                } else if (type === 'member') {
                    this.memberScripts.push(script);
                }
                
                this.saveState();
                return script;
            }
            
            // Existing script methods
            addScript(scriptData, type = 'script') {
                return this.addScriptByAdmin(scriptData, type);
            }
            
            deleteScript(scriptId, type) {
                if (type === 'script') {
                    this.scripts = this.scripts.filter(s => s.id !== scriptId);
                } else if (type === 'source') {
                    this.sourceScripts = this.sourceScripts.filter(s => s.id !== scriptId);
                } else if (type === 'member') {
                    this.memberScripts = this.memberScripts.filter(s => s.id !== scriptId);
                }
                this.saveState();
            }
            
            // Chat Management
            addChatMessage(sender, content) {
                const message = {
                    id: Date.now().toString(),
                    sender: sender.username,
                    senderColor: sender.color,
                    content,
                    timestamp: new Date().toISOString()
                };
                
                this.chatMessages.push(message);
                if (this.chatMessages.length > 100) {
                    this.chatMessages = this.chatMessages.slice(-100);
                }
                this.saveState();
                return message;
            }
        }

        // UI Components
        class UI {
            constructor() {
                this.state = new AppState();
                this.initEventListeners();
                this.updateUI();
                this.loadPage('info');
            }
            
            initEventListeners() {
                // Theme Toggle
                document.getElementById('themeToggle').addEventListener('click', () => {
                    document.body.classList.toggle('light-theme');
                    const icon = document.querySelector('#themeToggle i');
                    icon.classList.toggle('fa-moon');
                    icon.classList.toggle('fa-sun');
                    this.showNotification('Theme changed');
                });
                
                // Navigation
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const page = e.target.closest('.nav-tab').dataset.page;
                        this.loadPage(page);
                    });
                });
                
                // Login/Register Modal
                document.getElementById('close-login-modal').addEventListener('click', () => {
                    this.closeModal('login-modal');
                });
                
                document.getElementById('login-btn').addEventListener('click', () => {
                    this.handleLogin();
                });
                
                document.getElementById('register-btn').addEventListener('click', () => {
                    this.handleRegister();
                });
                
                // Script Modal
                document.getElementById('close-script-modal').addEventListener('click', () => {
                    this.closeModal('script-modal');
                });
                
                document.getElementById('copy-script-btn').addEventListener('click', () => {
                    this.copyScript();
                });
                
                // Share Source Form
                document.getElementById('submit-source').addEventListener('click', () => {
                    this.handleShareSource();
                });
                
                // Member Share Form
                document.getElementById('submit-member').addEventListener('click', () => {
                    this.handleMemberShare();
                });
                
                // Admin Add Script Form - NEW
                document.getElementById('admin-add-script-btn').addEventListener('click', () => {
                    this.handleAdminAddScript();
                });
                
                // Admin Moderator Controls
                document.getElementById('add-moderator').addEventListener('click', () => {
                    this.handleAddModerator();
                });
                
                // Chat
                document.getElementById('send-message').addEventListener('click', () => {
                    this.sendChatMessage();
                });
                
                document.getElementById('chat-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendChatMessage();
                    }
                });
                
                // Image Uploads
                this.initImageUploads();
            }
            
            initImageUploads() {
                // Source thumbnail upload
                const sourceUpload = document.getElementById('source-thumbnail-upload');
                const sourceInput = document.getElementById('source-image-input');
                const sourcePreview = document.getElementById('source-image-preview');
                
                sourceUpload.addEventListener('click', () => sourceInput.click());
                sourceInput.addEventListener('change', (e) => {
                    this.handleImageUpload(e, sourcePreview);
                });
                
                // Member thumbnail upload
                const memberUpload = document.getElementById('member-thumbnail-upload');
                const memberInput = document.getElementById('member-image-input');
                const memberPreview = document.getElementById('member-image-preview');
                
                memberUpload.addEventListener('click', () => memberInput.click());
                memberInput.addEventListener('change', (e) => {
                    this.handleImageUpload(e, memberPreview);
                });
                
                // Admin Add Script thumbnail upload - NEW
                const adminAddUpload = document.getElementById('admin-add-thumbnail-upload');
                const adminAddInput = document.getElementById('admin-add-image-input');
                const adminAddPreview = document.getElementById('admin-add-image-preview');
                
                adminAddUpload.addEventListener('click', () => adminAddInput.click());
                adminAddInput.addEventListener('change', (e) => {
                    this.handleImageUpload(e, adminAddPreview);
                });
            }
            
            handleImageUpload(event, previewElement) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        previewElement.src = e.target.result;
                        previewElement.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            }
            
            updateUI() {
                const userMenu = document.getElementById('userMenu');
                const adminElements = document.querySelectorAll('.admin-only');
                
                if (this.state.currentUser) {
                    userMenu.innerHTML = `
                        <span class="username">${this.state.currentUser.username}</span>
                        <span class="user-badge">${this.state.currentUser.role}</span>
                        <button class="auth-btn" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    `;
                    
                    document.getElementById('logout-btn').addEventListener('click', () => {
                        this.state.logout();
                        this.updateUI();
                        this.showNotification('Logged out successfully');
                    });
                    
                    // Show admin elements if user is admin
                    adminElements.forEach(el => {
                        el.style.display = this.state.isAdmin() ? 'flex' : 'none';
                    });
                } else {
                    userMenu.innerHTML = `
                        <button class="auth-btn" id="login-modal-btn">
                            <i class="fas fa-user"></i> Login / Register
                        </button>
                    `;
                    
                    document.getElementById('login-modal-btn').addEventListener('click', () => {
                        this.openModal('login-modal');
                    });
                    
                    // Hide admin elements
                    adminElements.forEach(el => {
                        el.style.display = 'none';
                    });
                }
                
                // Update chat placeholder
                const chatInput = document.getElementById('chat-input');
                chatInput.placeholder = this.state.currentUser 
                    ? 'Type your message...' 
                    : 'Login to send messages...';
                chatInput.disabled = !this.state.currentUser;
            }
            
            loadPage(page) {
                // Update active tab
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.page === page) {
                        tab.classList.add('active');
                    }
                });
                
                // Hide all pages, show selected
                document.querySelectorAll('.page').forEach(p => {
                    p.classList.remove('active');
                });
                document.getElementById(`${page}-page`).classList.add('active');
                
                // Load page-specific content
                switch(page) {
                    case 'home':
                        this.loadHomeScripts();
                        break;
                    case 'share-source':
                        this.loadShareSource();
                        break;
                    case 'member-share':
                        this.loadMemberScripts();
                        break;
                    case 'admin':
                        if (this.state.isAdmin()) {
                            this.loadAdminPanel();
                        } else {
                            this.loadPage('info');
                        }
                        break;
                    case 'chat':
                        this.loadChat();
                        break;
                }
            }
            
            loadHomeScripts() {
                const grid = document.getElementById('home-script-grid');
                grid.innerHTML = '';
                
                this.state.scripts.forEach(script => {
                    grid.appendChild(this.createScriptCard(script, 'script'));
                });
            }
            
            loadShareSource() {
                const grid = document.getElementById('source-script-grid');
                grid.innerHTML = '';
                
                // Check permissions
                const form = document.getElementById('share-source-form');
                if (this.state.isModerator()) {
                    form.style.display = 'block';
                } else {
                    form.style.display = 'none';
                    grid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                            <i class="fas fa-lock fa-3x" style="color: var(--text-muted); margin-bottom: 1rem;"></i>
                            <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">Moderators Only</h3>
                            <p style="color: var(--text-secondary);">Only moderators and admins can share source code.</p>
                        </div>
                    `;
                    return;
                }
                
                this.state.sourceScripts.forEach(script => {
                    grid.appendChild(this.createScriptCard(script, 'source'));
                });
            }
            
            loadMemberScripts() {
                const grid = document.getElementById('member-script-grid');
                grid.innerHTML = '';
                
                this.state.memberScripts.forEach(script => {
                    grid.appendChild(this.createScriptCard(script, 'member'));
                });
            }
            
            loadAdminPanel() {
                // Load moderator list
                const modList = document.getElementById('moderator-list');
                modList.innerHTML = '';
                
                this.state.moderators.forEach(username => {
                    const user = this.state.users.find(u => u.username === username);
                    if (user) {
                        const modCard = document.createElement('div');
                        modCard.className = 'moderator-card';
                        modCard.innerHTML = `
                            <div>
                                <strong style="color: ${user.color};">${username}</strong>
                                <div style="font-size: 0.8rem; color: var(--text-secondary);">
                                    ${user.role} • Joined ${new Date(user.createdAt).toLocaleDateString()}
                                </div>
                            </div>
                            <button class="btn btn-danger remove-moderator" data-username="${username}">
                                <i class="fas fa-times"></i> Remove
                            </button>
                        `;
                        modList.appendChild(modCard);
                    }
                });
                
                // Add event listeners for remove buttons
                modList.querySelectorAll('.remove-moderator').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const username = e.target.closest('.remove-moderator').dataset.username;
                        this.handleRemoveModerator(username);
                    });
                });
                
                // Load all scripts for admin management
                const grid = document.getElementById('admin-script-grid');
                grid.innerHTML = '';
                
                const allScripts = [
                    ...this.state.scripts.map(s => ({...s, type: 'script'})),
                    ...this.state.sourceScripts.map(s => ({...s, type: 'source'})),
                    ...this.state.memberScripts.map(s => ({...s, type: 'member'}))
                ];
                
                allScripts.forEach(script => {
                    grid.appendChild(this.createAdminScriptCard(script));
                });
            }
            
            loadChat() {
                const chatContainer = document.getElementById('chat-messages');
                chatContainer.innerHTML = '';
                
                this.state.chatMessages.forEach(msg => {
                    const isCurrentUser = msg.sender === this.state.currentUser?.username;
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `message ${isCurrentUser ? 'message-sent' : 'message-received'}`;
                    
                    const time = new Date(msg.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    // Only show sender name for received messages
                    const senderHTML = isCurrentUser ? '' : `<div class="message-sender" style="color: ${msg.senderColor};">${msg.sender}</div>`;
                    
                    messageDiv.innerHTML = `
                        ${senderHTML}
                        <div class="message-content">${msg.content}</div>
                        <div class="message-time">${time}</div>
                    `;
                    
                    chatContainer.appendChild(messageDiv);
                });
                
                // Scroll to bottom
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            createScriptCard(script, type) {
                const card = document.createElement('div');
                card.className = 'script-card';
                card.dataset.id = script.id;
                card.dataset.type = type;
                
                const thumbnail = script.thumbnail || '';
                const time = new Date(script.createdAt).toLocaleDateString();
                
                card.innerHTML = `
                    <div class="script-thumbnail">
                        ${thumbnail ? 
                            `<img src="${thumbnail}" alt="${script.title}">` :
                            `<i class="fas fa-code fa-3x" style="color: ${script.authorColor || '#6c63ff'}"></i>`
                        }
                    </div>
                    <div class="script-info">
                        <div class="script-header">
                            <div>
                                <h3 class="script-title">${script.title}</h3>
                                <div class="script-author">
                                    <i class="fas fa-user" style="color: ${script.authorColor || '#6c63ff'}"></i>
                                    ${script.author} • ${time}
                                </div>
                            </div>
                        </div>
                        <p class="script-description">${script.description || 'No description'}</p>
                        <div class="script-actions">
                            <button class="btn btn-primary view-script">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="btn btn-secondary copy-script">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                    </div>
                `;
                
                // Add event listeners
                card.querySelector('.view-script').addEventListener('click', () => {
                    this.viewScript(script);
                });
                
                card.querySelector('.copy-script').addEventListener('click', () => {
                    navigator.clipboard.writeText(script.content)
                        .then(() => this.showNotification('Script copied to clipboard!'))
                        .catch(() => this.showNotification('Failed to copy script', 'error'));
                });
                
                return card;
            }
            
            createAdminScriptCard(script) {
                const card = this.createScriptCard(script, script.type);
                
                // Add admin controls
                const actions = card.querySelector('.script-actions');
                actions.innerHTML += `
                    <button class="btn btn-warning edit-script">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-danger delete-script">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                `;
                
                // Add admin event listeners
                card.querySelector('.delete-script').addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (confirm('Are you sure you want to delete this script?')) {
                        this.state.deleteScript(script.id, script.type);
                        this.loadAdminPanel();
                        this.showNotification('Script deleted');
                    }
                });
                
                return card;
            }
            
            viewScript(script) {
                document.getElementById('modal-script-title').textContent = script.title;
                document.getElementById('modal-script-description').textContent = script.description || 'No description';
                document.getElementById('modal-script-content').textContent = script.content;
                this.openModal('script-modal');
            }
            
            copyScript() {
                const content = document.getElementById('modal-script-content').textContent;
                navigator.clipboard.writeText(content)
                    .then(() => this.showNotification('Script copied to clipboard!'))
                    .catch(() => this.showNotification('Failed to copy script', 'error'));
            }
            
            // Form Handlers
            async handleShareSource() {
                if (!this.state.isModerator()) {
                    this.showNotification('Only moderators can share source code', 'error');
                    return;
                }
                
                const title = document.getElementById('source-title').value.trim();
                const description = document.getElementById('source-description').value.trim();
                const content = document.getElementById('source-content').value.trim();
                const thumbnail = document.getElementById('source-image-preview').src || '';
                
                if (!title || !content) {
                    this.showNotification('Please fill in all required fields', 'error');
                    return;
                }
                
                const scriptData = {
                    title,
                    description,
                    content,
                    thumbnail,
                    author: this.state.currentUser.username,
                    authorColor: this.state.currentUser.color
                };
                
                this.state.addScript(scriptData, 'source');
                
                // Reset form
                document.getElementById('source-title').value = '';
                document.getElementById('source-description').value = '';
                document.getElementById('source-content').value = '';
                document.getElementById('source-image-preview').style.display = 'none';
                document.getElementById('source-image-preview').src = '';
                
                this.loadShareSource();
                this.showNotification('Source code shared successfully!');
            }
            
            async handleMemberShare() {
                if (!this.state.currentUser) {
                    this.showNotification('Please login to share scripts', 'error');
                    return;
                }
                
                const title = document.getElementById('member-title').value.trim();
                const description = document.getElementById('member-description').value.trim();
                const content = document.getElementById('member-content').value.trim();
                const thumbnail = document.getElementById('member-image-preview').src || '';
                
                if (!title || !content) {
                    this.showNotification('Please fill in all required fields', 'error');
                    return;
                }
                
                const scriptData = {
                    title,
                    description,
                    content,
                    thumbnail,
                    author: this.state.currentUser.username,
                    authorColor: this.state.currentUser.color
                };
                
                this.state.addScript(scriptData, 'member');
                
                // Reset form
                document.getElementById('member-title').value = '';
                document.getElementById('member-description').value = '';
                document.getElementById('member-content').value = '';
                document.getElementById('member-image-preview').style.display = 'none';
                document.getElementById('member-image-preview').src = '';
                
                this.loadMemberScripts();
                this.showNotification('Script shared successfully!');
            }
            
            // NEW: Admin Add Script Handler
            async handleAdminAddScript() {
                if (!this.state.isAdmin()) {
                    this.showNotification('Only admins can add scripts', 'error');
                    return;
                }
                
                const title = document.getElementById('admin-add-title').value.trim();
                const description = document.getElementById('admin-add-description').value.trim();
                const content = document.getElementById('admin-add-content').value.trim();
                const thumbnail = document.getElementById('admin-add-image-preview').src || '';
                const type = document.getElementById('admin-add-type').value;
                
                if (!title || !content) {
                    this.showNotification('Please fill in all required fields', 'error');
                    return;
                }
                
                const scriptData = {
                    title,
                    description,
                    content,
                    thumbnail,
                    author: this.state.currentUser.username,
                    authorColor: this.state.currentUser.color
                };
                
                this.state.addScriptByAdmin(scriptData, type);
                
                // Reset form
                document.getElementById('admin-add-title').value = '';
                document.getElementById('admin-add-description').value = '';
                document.getElementById('admin-add-content').value = '';
                document.getElementById('admin-add-image-preview').style.display = 'none';
                document.getElementById('admin-add-image-preview').src = '';
                
                // Reload all relevant pages
                if (type === 'script') this.loadHomeScripts();
                else if (type === 'source') this.loadShareSource();
                else if (type === 'member') this.loadMemberScripts();
                
                this.loadAdminPanel();
                this.showNotification('Script added successfully!');
            }
            
            handleAddModerator() {
                if (!this.state.isAdmin()) {
                    this.showNotification('Only admins can add moderators', 'error');
                    return;
                }
                
                const username = document.getElementById('mod-username').value.trim();
                if (!username) {
                    this.showNotification('Please enter a username', 'error');
                    return;
                }
                
                const result = this.state.addModerator(username);
                if (result.success) {
                    document.getElementById('mod-username').value = '';
                    this.loadAdminPanel();
                    this.showNotification(result.message);
                } else {
                    this.showNotification(result.message, 'error');
                }
            }
            
            handleRemoveModerator(username) {
                if (!this.state.isAdmin()) return;
                
                const result = this.state.removeModerator(username);
                if (result.success) {
                    this.loadAdminPanel();
                    this.showNotification(result.message);
                } else {
                    this.showNotification(result.message, 'error');
                }
            }
            
            // Chat Handlers
            sendChatMessage() {
                if (!this.state.currentUser) {
                    this.showNotification('Please login to send messages', 'error');
                    return;
                }
                
                const input = document.getElementById('chat-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                this.state.addChatMessage(this.state.currentUser, message);
                input.value = '';
                
                this.loadChat();
            }
            
            // Login/Register Handlers
            handleLogin() {
                const username = document.getElementById('login-username').value.trim();
                const password = document.getElementById('login-password').value.trim();
                
                if (!username || !password) {
                    this.showNotification('Please fill in all fields', 'error');
                    return;
                }
                
                const result = this.state.loginUser(username, password);
                if (result.success) {
                    this.closeModal('login-modal');
                    this.updateUI();
                    this.showNotification(`Welcome back, ${username}!`);
                    this.loadPage('home');
                } else {
                    this.showNotification(result.message, 'error');
                }
            }
            
            handleRegister() {
                const username = document.getElementById('login-username').value.trim();
                const password = document.getElementById('login-password').value.trim();
                
                if (!username || !password) {
                    this.showNotification('Please fill in all fields', 'error');
                    return;
                }
                
                if (username.length < 3) {
                    this.showNotification('Username must be at least 3 characters', 'error');
                    return;
                }
                
                if (password.length < 6) {
                    this.showNotification('Password must be at least 6 characters', 'error');
                    return;
                }
                
                const result = this.state.registerUser(username, password);
                if (result.success) {
                    this.state.currentUser = result.user;
                    this.closeModal('login-modal');
                    this.updateUI();
                    this.showNotification(`Account created! Welcome, ${username}!`);
                    this.loadPage('home');
                } else {
                    this.showNotification(result.message, 'error');
                }
            }
            
            // Modal Controls
            openModal(modalId) {
                document.getElementById(modalId).classList.add('active');
            }
            
            closeModal(modalId) {
                document.getElementById(modalId).classList.remove('active');
            }
            
            // Notification System
            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                const icon = document.getElementById('notification-icon');
                const text = document.getElementById('notification-text');
                
                // Set icon based on type
                icon.className = 'fas ' + (
                    type === 'success' ? 'fa-check-circle' :
                    type === 'error' ? 'fa-exclamation-circle' :
                    'fa-info-circle'
                );
                
                // Set color based on type
                notification.style.borderLeftColor = 
                    type === 'success' ? 'var(--success-color)' :
                    type === 'error' ? 'var(--danger-color)' :
                    'var(--warning-color)';
                
                text.textContent = message;
                notification.classList.add('active');
                
                setTimeout(() => {
                    notification.classList.remove('active');
                }, 3000);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            const app = new UI();
            
            // Close modals on overlay click
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });
            
            // Close modals with Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            });
            
            console.log('Meow Script Web initialized!');
            console.log('Admin login: username="Anura123", password="Anura123"');
        });
    </script>
</body>
</html>
